name: Deploy Hugging Face Space

on:
  push:
    branches:
      - main 

permissions:
  contents: write

jobs:
  sync-space:
    runs-on: ubuntu-latest
    
    steps:
      # 1. Checkout do seu repositório GitHub
      - name: Checkout Repository
        uses: actions/checkout@v4
        
      # 2. Configura o Python
      - name: Set up Python 3.x
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      # 3. Instala a biblioteca Hugging Face
      - name: Install Hugging Face Hub
        run: pip install huggingface-hub

      # 4. Sincroniza o repositório via Hugging Face CLI
      # Este passo usa o token e o ID que você já tem.
      - name: Sync to Hugging Face Space using hf-cli
        env:
          # Define as variáveis de ambiente necessárias
          HF_TOKEN: ${{ secrets.HF }}
          REPO_ID: willp01/projeto001 # Seu Space ID
        run: |
          # 4a. Faz login no Hugging Face (usa o HF_TOKEN)
          huggingface-cli login --token $HF_TOKEN

          # 4b. Cria o repositório (se não existir). 
          # O erro de 'private' é evitado aqui, pois o hf-cli lida com isso corretamente.
          huggingface-cli create-repo $REPO_ID --type space --space-sdk gradio || echo "Repo already exists"

          # 4c. Sincroniza os arquivos
          # Este comando copia os arquivos locais (do GitHub) para o Space.
          huggingface-cli upload $REPO_ID . --include "*" --exclude ".git*"
